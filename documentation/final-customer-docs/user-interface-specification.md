# Пользовательский интерфейс AI GOST — описание экранов

**Назначение документа**: описать целевые экраны и UX системы AI GOST для согласования с заказчиком. Документ отражает требования из SRS/functional-requirements и прототипа «Обработка документов».

## 1. Роли, аутентификация и проектный контекст
- **Экран входа**: логин, пароль/токен, выбор роли (если доступно). Ошибки авторизации и блокировки отображаются явно.
- **Контекст проекта**: обязательные `projectId/rdCipher` при работе; баннер активного проекта, быстрый выбор последнего, предупреждение при отсутствии.
- **ACL**: доступность экранов/действий зависит от роли (Учитель, Пользователь, Администратор); при нарушении ACL — отказ с причиной и запись в журнал.

## 2. Импорт и обработка документов
- **Загрузка**: drag&drop файлов и кнопка «Импорт папки» (рекурсивно). Поддержка PDF/JPG/PNG/ARP/GSFX/XML/XLS/XLSX/DWG/DXF/DOCX. Список файлов с типом, размером, страницами, статусом ACL.
- **Чек-лист задач**: штамп, таблицы, смета, нормативка, отчёты; можно включать/выключать перед запуском. Поле «Инструкция системе» (промт) и выбор ГОСТ/СП.
- **Запуск обработки**: кнопка «Обработать», выбор режима ответа (list/detail/aggregate), фильтры (дата/тип/стадия/материалы), лимит выдачи. Параллельная очередь, ошибки не останавливают остальные файлы.
- **Прогресс и SLA**: шаги пайплайна (детект PDF ≤3 с/док, OCR ≤30 с/стр., общий ответ ≤30 с), таймеры по шагам, статусы (выполняется/готово/ошибка).
- **Результаты**: по каждому файлу — метаданные, ссылки на артефакты (titleBlock.json, tables.json/CSV, estimate.json/CSV, validationReport.json, итоговые Excel/CSV/JSON/PDF, trace), просмотр/скачивание, разворот извлечённого текста, ошибки/предупреждения.
- **Экспорт**: кнопка «Экспорт результатов» (архив артефактов/отчётов), сохранение настроек запуска как пресета.

## 3. Пресеты и обучение (роль Учитель)
- **Промт задачи**: форма для описания действий системы, шаблоны промтов, автоподстановка projectId/rdCipher.
- **Входные и эталонные файлы**: загрузка примеров входов и целевых выходов; таблица связок вход → эталон. Пометка «Эталон» для обучения.
- **Сохранение наборов**: кнопка «Сохранить как обучающий набор» (промт, входы, эталоны, ГОСТ/СП, настройки). Повторное применение набора в других проектах.
- **Подтверждение качества**: подсветка полей с низким confidence/CER-WER, отметки «Принять/Исправить», комментарии; влияние на правила проекта.

## 4. Версии артефактов и знаний
- **Реестр версий**: таблица с метками Reference/Draft, автором, временем, changeSummary, ссылками на артефакты. Действия: сравнить, откатить (создать новую версию), опубликовать Reference.
- **Доступность**: Учитель управляет версиями; Пользователь читает Reference; Админ задаёт политику ретенции/очистки.

## 5. Сметы и round-trip
- **Импорт**: ARP/GSFX/XML/XLSX в модель Estimate (разделы → позиции → ресурсы).
- **Просмотр/правки**: дерево сметы, статусы формул (OK/Warning/Broken), редактирование коэффициентов/цен, сверка итогов.
- **Экспорт**: round-trip обратно в исходный формат, отчёт об отклонениях и статусах формул.

## 6. Реестр шаблонов Excel и валидация
- **Список шаблонов**: название, версия, владелец, статус (активен/черновик), область применения.
- **Операции**: загрузка нового, активация, откат версии, комментарии к изменениям.
- **Проверка отчёта**: форма «Проверить по шаблону», просмотр validationReport (ошибка/предупреждение, лист/ячейка/формула), экспорт отчёта.

## 7. Нормативка (ГОСТ/СП)
- **Загрузка/версии**: вкладка «Нормативка», загрузка DOCX/PDF, метаданные (номер, название, редакция, дата), выбор активной версии.
- **Правила**: таблица правил с уровнями Critical/Warning/Info, фильтры, покрытие приоритетных норм (%), журнал изменений.
- **Проверка**: выбор проекта/отчёта/сметы, кнопка «Проверить по ГОСТ», отчёт о несоответствиях (ссылки на норматив/пункт/страницу/редакцию), экспорт validationReport.json и PDF выжимок.
- **Пороги и ACL**: настройки порогов блокировки, ретенция версий; доступ к загрузке/активации у Учителя/Админа.

## 8. Поиск аналогов и готовые отчёты
- **Фильтры**: тип объекта, стадия, материалы, теги, даты, лимит выдачи.
- **Выдача**: список аналогов с признаками сходства и trace на артефакты.
- **Отчёты**: кнопки запуска готовых отчётов (спецификация, бюджет, сравнение проектов/аналогов), экспорт в Excel/CSV/JSON/PDF.

## 9. API и интеграции
- **Токены**: реестр токенов (проект, роль, срок действия, статус), создание/ротация/отзыв.
- **Webhooks**: настройка URL, ретраи, SLA; просмотр журнала доставок/ошибок; лимиты запросов.
- **Включение/отключение** внешних интеграций с фиксацией в журнале.

## 10. Логи и аудит
- **Журналы**: операции пользователей (кто/что/когда/проект/статус), шаги обработки, ошибки.
- **Фильтры**: по пользователю, проекту, операции, шагу пайплайна; экспорт логов; отметка попыток изменения/удаления.
- **Доступ**: Администратор — полный; Учитель — по своим проектам; Пользователь — по собственным запросам.

## 11. Мониторинг и SLA
- **Дашборд**: времена по шагам (OCR/штамп/таблицы/сметы/нормативка/отчёты), состояние очередей, предупреждения о превышении лимитов размеров/страниц/слоёв.
- **Ресурсы**: состояние бэкапов/ретенции, использование диска/CPU/GPU (если доступно локально).
- **Статусы**: success/warning/error, уведомления об инцидентах SLA.

## 12. Настройки окружения
- **Параметры**: пути хранилищ, лимиты размеров файлов/страниц/листов/слоёв DXF, параметры моделей (OCR/LLM), офлайн-режим.
- **Бэкапы/ретенция**: политика очистки версий/логов, расписание резервного копирования.
- **Доступ**: только Администратор; проверки валидации при сохранении.

## 13. Общие UX-паттерны
- Состояния: initial/loading/success/error для всех форм; явные сообщения об ошибках и предупреждениях.
- Trace и источники: во всех отчётах и ответах отображаются ссылки на документ/страницу/фрагмент.
- Экспорт: единый формат скачивания (архив с артефактами) и прямые ссылки на ключевые файлы.
- Журналирование: все критичные действия (загрузка, активация, откат, выдача привилегий) пишутся в аудит.

