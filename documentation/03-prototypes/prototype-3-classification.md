# Прототип 3: Тематическая классификация и интерактивный слой знаний

## Цель

Демонстрация способности системы выполнять тематическую классификацию документов, строить интерактивный слой знаний и обеспечивать ответы на текстовые запросы в проектном контексте с механизмами диалога и уточнений.

## Основная реализация

- **Тематическая классификация**: автоматическое отнесение документов к тематическим категориям с использованием NLP-моделей
- **Интерактивный слой знаний**: построение базы знаний с возможностью диалога для Учителя и Пользователя системы
- **Ответы на текстовые запросы**: обработка естественных запросов на русском языке в проектном контексте
- **Механизмы извлечения**: диалог для уточнений, ссылки на источники, сохранение версий знаний
- **Поиск по контексту**: семантический поиск с учетом проектной принадлежности и тематической классификации

## Выходные артефакты

- **Классификационные теги**: тематические категории с уровнями уверенности для каждого документа
- **projectKnowledge.json**: структурированная база знаний с проектной привязкой и метаданными
- **Отчеты по метрикам**: анализ качества классификации и извлечения знаний
- **Журналы диалогов**: записи взаимодействий с системой для обучения и аудита

---

## План реализации

### Этап 1: Подготовка данных (2 дня)
- [ ] Сбор образцов документов по категориям
- [ ] Предобработка текстов
- [ ] Создание обучающей выборки
- [ ] Анализ специфики домена
- [ ] Подготовка проектных данных

### Этап 2: Модели классификации (4 дня)
- [ ] Обучение baseline-модели (TF-IDF + SVM)
- [ ] Тестирование предобученных моделей (BERT, RoBERTa)
- [ ] Fine-tuning на корпоративных данных
- [ ] Сравнение подходов

### Этап 3: Проектно-ориентированная работа (4 дня)
- [ ] Реализация проектной классификации документов
- [ ] Разработка алгоритмов поиска аналогов
- [ ] Создание системы сравнения проектов
- [ ] Интеграция с базой знаний

### Этап 4: Оценка качества (2 дня)
- [ ] Метрики precision/recall/F1-score
- [ ] Cross-validation
- [ ] Тестирование на новых документах
- [ ] Анализ ошибок
- [ ] Тестирование поиска аналогов

### Этап 5: Интеграция (2 дня)
- [ ] API для классификации
- [ ] API для поиска аналогов
- [ ] Batch-обработка документов
- [ ] Логирование результатов
- [ ] Мониторинг качества

---

## Критерии успеха

- **Качество классификации**: macro-F1 ≥ целевого порога для тематических категорий
- **Точность извлечения**: precision/recall на уровне требований для извлечения знаний из документов
- **Соблюдение ACL**: разграничение доступа по ролям и проектным атрибутам
- **Офлайн-режим**: работа без доступа к интернету (NFR-007)
- **Документирование процедур**: полное описание процедур запуска и эксплуатации (NFR-OPS-01)
- **Интерактивность**: поддержка диалога для уточнений и ссылок на источники

---

## Технический стек

- **ML Framework**: scikit-learn, transformers
- **NLP**: spaCy, NLTK, BERT
- **Векторизация**: TF-IDF, Word2Vec, BERT embeddings
- **Поиск**: Elasticsearch, FAISS для поиска аналогов
- **База данных**: PostgreSQL для проектных данных
- **Excel**: openpyxl для отчетов
- **Язык**: Python 3.11+
- **Контейнеризация**: Docker

---

## Категории документов

### Основные темы (предварительно)
- Техническая документация
- Финансовые документы
- Договоры и соглашения
- Отчеты и аналитика
- Чертежи и схемы
- Сметы и расчеты
- Переписка
- Нормативные документы

### Проектные категории
- **Подстанция беговая** - все документы по проекту подстанции
- **Козырек** - документы по проекту козырька
- **Здания** - архитектурно-строительная документация
- **Инфраструктура** - инженерные системы
- **Другие проекты** - прочие проекты заказчика

---

## Метрики качества

- **Precision**: Доля правильно классифицированных документов
- **Recall**: Доля найденных документов категории
- **F1-score**: Гармоническое среднее precision и recall
- **Confusion Matrix**: Детальный анализ ошибок
- **Проектная точность**: Доля правильно привязанных к проектам документов
- **Качество аналогов**: Релевантность найденных аналогичных проектов
- **Время поиска**: Скорость выполнения поиска аналогов

---

## Риски

- Недостаток обучающих данных
- Специфика корпоративной терминологии
- Изменение тематик со временем
- Производительность больших моделей
- Сложность определения проектных границ
- Неоднозначность критериев поиска аналогов
 - Качество проектной классификации

---

## Demo Script (без метрик)
1. Импорт нормализованных данных из P1/P2 (документы, метаданные, таблицы, сметы).
2. Классификация документов по тематикам и проектам; показ проектной привязки.
3. Поиск аналогов (UC‑11): запрос → построение векторного запроса → выдача проектов.
4. Пересечения с нормативной базой: показ кросс‑ссылок в разрезе тематик/проектов.
5. Экспорт результатов поиска аналогов в XLSX.

## Acceptance Checklist (без метрик)
- [ ] Документы классифицированы по темам и проектам, привязка видна в интерфейсе/логах.
- [ ] Поиск аналогов возвращает релевантные проекты с краткой структурой данных.
- [ ] Кросс‑ссылки на нормативку отображаются (номер/название/дата).
- [ ] Экспорт результатов поиска аналогов в XLSX доступен.

---

## Sample data pack (для демонстрации)
- Нормализованные данные из P1/P2 (метаданные, таблицы, Estimate JSON, XLS отчёты).
- Тестовые запросы для UC‑11 (поиск аналогов).

Связанные UC: UC‑03, UC‑11, UC‑06/UC‑16.

---

## Трассировка требований

- **BR-001**: Создание интеллектуальной системы обучения - прототип обеспечивает накопление знаний и обучение на документах
- **BR-002**: Обработка текстовых запросов пользователей - реализована обработка естественных запросов на русском языке
- **BR-003**: Проектно-ориентированная работа с данными - все данные привязаны к конкретным проектам с поиском аналогов
- **FR-SEARCH-01..04**: Поиск по контексту - семантический поиск с учетом проектной принадлежности и тематической классификации
- **FR-KNOW-01/02**: Управление знаниями - построение интерактивного слоя знаний с диалогом и уточнениями
- **FR-LEARN-04**: Обучение системы - накопление знаний о проектах и технических решениях
- **NFR-SEC-01**: Безопасность - соблюдение ACL и разграничение доступа по ролям
- **NFR-REL-03**: Надежность - стабильная работа системы классификации и извлечения знаний
- **NFR-OPS-01**: Эксплуатация - документирование процедур запуска и эксплуатации системы
